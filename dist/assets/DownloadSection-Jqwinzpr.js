import{r,j as e,B as n,I as m,L as y}from"./index-CjafWCjW.js";import{u as f,E as w}from"./useTranscription-lq7WLSPY.js";import{d as N}from"./transcription-BuDXvoUS.js";const v=["txt","srt","json"],C=({className:x=""})=>{const{state:t,dispatch:g}=f(),[o,h]=r.useState("txt"),[p,i]=r.useState(!1),[l,a]=r.useState(null),d=async s=>{if(a(null),!s){a("No session selected for download.");return}i(!0);try{await N(s,o)}catch(c){const j=c instanceof Error?c.message:"Failed to download transcription";a(j)}finally{i(!1)}},u=s=>g({type:"set_current",payload:s});return e.jsxs("section",{className:`bg-gray-800 rounded-xl p-4 sm:p-6 ${x}`,"aria-label":"Download section",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Downloads"}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("label",{htmlFor:"format-select",className:"text-gray-300",children:"Format"}),e.jsx("select",{id:"format-select",value:o,onChange:s=>h(s.target.value),className:"bg-gray-900 text-gray-200 border border-gray-700 rounded-lg px-3 py-2",children:v.map(s=>e.jsx("option",{value:s,children:s.toUpperCase()},s))}),e.jsxs(n,{variant:"outline",onClick:()=>d(t.currentSessionId),className:"border-gray-600 text-gray-300 hover:text-white hover:border-gray-500",children:[e.jsx(m,{name:"download",size:18,"aria-hidden":!0})," Download Current"]})]}),p&&e.jsx(y,{size:"sm",text:"Preparing download..."}),l&&e.jsx(w,{message:l,onDismiss:()=>a(null)}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Session History"}),t.sessions.length===0?e.jsx("p",{className:"text-gray-400",children:"No sessions yet. Process a file or start live transcription."}):e.jsx("ul",{className:"divide-y divide-gray-700 rounded-lg overflow-hidden border border-gray-700",children:t.sessions.map(s=>e.jsx("li",{className:`p-3 sm:p-4 bg-gray-900 ${s.id===t.currentSessionId?"bg-gray-800":""}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-gray-200 font-medium truncate",children:s.id}),e.jsxs("p",{className:"text-gray-400 text-sm truncate",children:[s.language," â€¢ ",new Date(s.createdAt).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>u(s.id),className:"text-gray-300 hover:text-white",children:"Select"}),e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>d(s.id),className:"text-gray-300 hover:text-white flex items-center gap-1",children:[e.jsx(m,{name:"download",size:16,"aria-hidden":!0}),e.jsx("span",{children:"Download"})]})]})]})},s.id))})]})]})};export{C as default};
